<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
					function OptanonWrapper() { }
				</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  Shader compilation</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://docs.unity3d.com/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1639761219"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1639761219"></script><script type="text/javascript" src="docdata/toc.js?ts=1639761219"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1639761219"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1639761219">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="none" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2020.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/shader-compilation.html">English</a></li>
<li><a href="/cn/current/Manual/shader-compilation.html">中文</a></li>
<li><a href="/ja/current/Manual/shader-compilation.html">日本語</a></li>
<li><a href="/es/current/Manual/shader-compilation.html">Español</a></li>
<li><a href="/kr/current/Manual/shader-compilation.html">한국어</a></li>
<li><a href="/ru/current/Manual/shader-compilation.html">Русский</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2020.3</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/shader-compilation.html">English</a></li>
<li><a href="/cn/current/Manual/shader-compilation.html">中文</a></li>
<li><a href="/ja/current/Manual/shader-compilation.html">日本語</a></li>
<li><a href="/es/current/Manual/shader-compilation.html">Español</a></li>
<li><a href="/kr/current/Manual/shader-compilation.html">한국어</a></li>
<li><a href="/ru/current/Manual/shader-compilation.html">Русский</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html"> Unity User Manual 2020.3 (LTS)</a></li>
<li><a href="Graphics.html">Graphics</a></li>
<li><a href="Shaders.html"> Shaders</a></li>
<li><a href="ShadersOverview.html"> Shaders core concepts</a></li>
<li> Shader compilation</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="class-Shader.html"></a></span><div class="tip"> Shader assets</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="AsynchronousShaderCompilation.html"></a></span><div class="tip"> Asynchronous shader compilation</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>Shader compilation</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<h2>Overview</h2>

<p>Every time you build your project, the Unity Editor compiles all the shaders that your build requires: every required <span class="tooltip"><strong>shader</strong><span class="tooltiptext">A program that runs on the GPU. <a class="tooltipMoreInfoLink" href="Shaders.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Shader">Glossary</a></span></span></span> variant, for every required graphics API.</p>

<p>When you’re working in the Unity Editor, the Editor does not compile everything upfront. This is because compiling every variant for every graphics API can take a very long time. </p>

<p>Instead, Unity Editor does this:</p>

<ul>
<li>When it imports a shader asset, it performs some minimal processing (such as Surface Shader generation).</li>
<li>When it needs to show a shader variant, it checks the <code>Library/ShaderCache</code> folder.</li>
<li>If it finds a previously compiled shader variant that uses identicial source code, it uses that.</li>
<li>If it does not find a match, it compiles the required shader variant and saves the result to the cache.

<ul>
<li>
<strong>Note:</strong> If you enable <a href="AsynchronousShaderCompilation.html">Asynchronous shader compilation</a>, it does this in the background and shows a placeholder shader in the meantime.</li>
</ul>
</li>
</ul>

<p>Shader compilation is carried out using a process called <code>UnityShaderCompiler</code>. Multiple <code>UnityShaderCompiler</code> processes can be started (generally one per CPU core in your machine), so that at player build time shader compilation can be done in parallel. While the Editor is not compiling shaders, the compiler processes do nothing and do not consume computer resources.</p>

<p>The shader cache folder can become quite large, if you have a lot of shaders that are changed often. It is safe to delete this folder; it just causes Unity to recompile the shader variants.</p>

<p>At player build time, all the “not yet compiled” shader variants are compiled, so that they are in the game data even if the editor did not happen to use them.</p>

<h2>Different shader compilers</h2>

<p>Different platforms use different shader compilers for <a href="SL-ShaderPrograms.html">shader program</a> compilation as follows:</p>

<ul>
<li>Platforms that use DirectX use Microsoft’s FXC HLSL compiler.</li>
<li>Platforms that use OpenGL (Core &amp; ES) use Microsoft’s FXC HLSL compiler, followed by bytecode translation into GLSL using <a href="https://github.com/Unity-Technologies/HLSLcc">HLSLcc</a>.</li>
<li>Platforms that use Metal use Microsoft’s FXC HLSL compiler, followed by bytecode translation into Metal, using <a href="https://github.com/Unity-Technologies/HLSLcc">HLSLcc</a>.</li>
<li>Platforms that use Vulkan use Microsoft’s FXC HLSL compiler, followed by bytecode translation into SPIR-V, using <a href="https://github.com/Unity-Technologies/HLSLcc">HLSLcc</a>.</li>
<li>Other platforms, such as console platforms, use their respective compilers.</li>
<li><span class="tooltip"><a class="tooltipMoreInfoLink" href="SL-SurfaceShaders.html">Surface Shaders</a><span class="tooltiptext">A streamlined way of writing shaders for the Built-in Render Pipeline. <a href="SL-SurfaceShaders.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#SurfaceShader">Glossary</a></span></span></span> use HLSL and <a href="https://icculus.org/mojoshader/">MojoShader</a> for code generation analysis step.</li>
</ul>

<p>You can configure various shader compiler settings using <a href="SL-PragmaDirectives.html">pragma directives</a>.</p>

<p><a name="preprocessor"></a></p>

<p><a name="caching-shader-preprocessor"></a></p>

<h2>The Caching Shader Preprocessor</h2>

<p>Shader compilation involves several steps. One of the first steps is preprocessing. During this step, a program called a <strong>preprocessor</strong> prepares the shader source code for the compiler.</p>

<p>In previous versions of Unity, the Editor used the preprocessor provided by the shader compiler for the current platform. Now, you can choose whether to use Unity’s Caching Shader Preprocessor, or revert to the previous behavior. Unless you experience problems, you should use the Caching Shader Preprocessor.</p>

<p>The Caching Shader Preprocessor is optimized for faster shader import and compilation; it is up to 25% faster. It works by caching intermediate preprocessing data, so the Editor only needs to parse include files when their contents change. This makes compiling multiple variants of the same shader more efficient. Enabling the Caching Shader Preprocessor has the most noticeable effect when shaders within a project use a large set of common include files.</p>

<p>As well as improved performance, the Caching Shader Preprocessor adds the following features:</p>

<ul>
<li>Limited support for <code>#pragma</code> directives inside conditionals.</li>
<li>Support for the <code>#pragma warning</code> directive.</li>
<li>Support for the <code>#include_with_pragmas</code> directive, which allows you to put <code>#pragma</code> directives in include files.</li>
<li>The <strong>Preprocess Only</strong> checkbox in the <a href="class-Shader.html">shader Inspector</a>, which lets you view the preprocessed source for that shader asset.</li>
</ul>

<p>For detailed information on the differences between the Caching Shader Preprocessor and the previous behavior, see the Unity forum: <a href="https://forum.unity.com/threads/new-shader-preprocessor.790328/">New shader preprocessor</a>.</p>

<p>You can enable or disable the Caching Shader Preprocessor with the <strong>Caching Shader Preprocessor</strong> checkbox in the <strong>Shader Compilation</strong> section of the <a href="class-EditorManager.html">Editor settings</a> window, or with the <a href="../ScriptReference/EditorSettings-cachingShaderPreprocessor.html">EditorSettings.cachingShaderPreprocessor</a> API.</p>

<h2>Build time stripping</h2>

<p>While building the game, Unity can detect that some of the internal shader variants are not used by the game, and exclude (“strip”) them from build data. For more information, see <span class="tooltip"><a class="tooltipMoreInfoLink" href="shader-variants.html">Shader variants</a><span class="tooltiptext">A verion of a shader program that Unity generates according to a specific combination of shader keywords and their status. A Shader object can contain multiple shader variants. <a href="shader-variants.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Shadervariant">Glossary</a></span></span></span>.</p>
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="class-Shader.html"></a></span><div class="tip"> Shader assets</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="AsynchronousShaderCompilation.html"></a></span><div class="tip"> Asynchronous shader compilation</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2021 Unity Technologies. Publication Date: 2021-12-17.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a><a href="https://docs.unity3d.com/Manual/TermsOfUse.html">Terms of use</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
